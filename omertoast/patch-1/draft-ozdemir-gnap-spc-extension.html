<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>GNAP Secure Payment Confirmation Extension</title>
<meta content="Omer Talha Ozdemir" name="author">
<meta content="Adrian Hope-Bailie" name="author">
<meta content="
       GNAP Secure Payment Confirmation (SPC) Extension is a Grant Negotiation and Authorization Protocol ( ) extension that defines a method for authentication of the end user during a payment transaction. This extension helps leverage hardware and software authenticators such as biometric scanners while authenticating the end user. 
    " name="description">
<meta content="xml2rfc 3.16.0" name="generator">
<meta content="gnap" name="keyword">
<meta content="secure payment confirmation" name="keyword">
<meta content="extension" name="keyword">
<meta content="draft-ozdemir-gnap-spc-extension-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.16.0
    Python 3.10.10
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.1
    setuptools 65.6.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ozdemir-gnap-spc-extension.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">GNAP Secure Payment Confirmation Extensi</td>
<td class="right">March 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Ozdemir &amp; Hope-Bailie</td>
<td class="center">Expires 14 September 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Grant Negotiation and Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ozdemir-gnap-spc-extension-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-03-13" class="published">13 March 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-09-14">14 September 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">O. T. Ozdemir</div>
<div class="org">Fynbos</div>
</div>
<div class="author">
      <div class="author-name">A. Hope-Bailie</div>
<div class="org">Fynbos</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">GNAP Secure Payment Confirmation Extension</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">GNAP Secure Payment Confirmation (SPC) Extension is a Grant Negotiation and Authorization Protocol (<span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>) extension that defines a method for authentication of the end user during a payment transaction. This extension helps leverage hardware and software authenticators such as biometric scanners while authenticating the end user.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://fynbos-dev.github.io/gnap-spc-extension/draft-ozdemir-gnap-spc-extension.html">https://fynbos-dev.github.io/gnap-spc-extension/draft-ozdemir-gnap-spc-extension.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ozdemir-gnap-spc-extension/">https://datatracker.ietf.org/doc/draft-ozdemir-gnap-spc-extension/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/fynbos-dev/gnap-spc-extension">https://github.com/fynbos-dev/gnap-spc-extension</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 14 September 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-secure-payment-confirmation" class="internal xref">Secure Payment Confirmation Interaction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requesting-credentials" class="internal xref">Requesting Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-providing-a-credential-chal" class="internal xref">Providing a Credential Challenge</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-authenticating-user" class="internal xref">Authenticating User</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-completing-interaction" class="internal xref">Completing Interaction</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-verifying-authentication-as" class="internal xref">Verifying Authentication Assertion</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-interaction-start-modes" class="internal xref">Interaction Start Modes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-interaction-mode-responses" class="internal xref">Interaction Mode Responses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-grant-request-parameters" class="internal xref">Grant Request Parameters</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-checking-feature-support" class="internal xref">Checking Feature Support</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">GNAP Secure Payment Confirmation Extension is an extension developed on top of the Grant Negotiation and Agreement Protocol <span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>. It defines a method for authentication of the end user during a payment transaction using Secure Payment Confirmation (<span>[<a href="#SPC" class="cite xref">SPC</a>]</span>). This extension helps leverage authenticators such as fingerprint scanners, facial recognition systems, etc. while authenticating during a GNAP interaction.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A method for detecting this capability in the client software is provided in <a href="#detect-spc" class="auto internal xref">Appendix A</a>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="conventions-and-definitions">
<section id="section-1.1">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="secure-payment-confirmation-interaction">
<section id="section-2">
      <h2 id="name-secure-payment-confirmation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-secure-payment-confirmation" class="section-name selfRef">Secure Payment Confirmation Interaction</a>
      </h2>
<p id="section-2-1">When using SPC in <span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>, the end user is prompted to authenticate during the interaction phase of the protocol, when the grant is in the <em>pending</em> state.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The overall flow of the protocol is shown here:<a href="#section-2-2" class="pilcrow">¶</a></p>
<div id="section-2-3">
        <div class="alignLeft art-svg artwork" id="section-2-3.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="432" width="440" viewBox="0 0 440 432" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
            <path d="M 8,32 L 8,416" fill="none" stroke="black"></path>
            <path d="M 80,32 L 80,416" fill="none" stroke="black"></path>
            <path d="M 168,176 L 168,240" fill="none" stroke="black"></path>
            <path d="M 224,176 L 224,240" fill="none" stroke="black"></path>
            <path d="M 360,32 L 360,416" fill="none" stroke="black"></path>
            <path d="M 432,32 L 432,416" fill="none" stroke="black"></path>
            <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
            <path d="M 360,32 L 432,32" fill="none" stroke="black"></path>
            <path d="M 80,96 L 104,96" fill="none" stroke="black"></path>
            <path d="M 120,96 L 144,96" fill="none" stroke="black"></path>
            <path d="M 280,96 L 352,96" fill="none" stroke="black"></path>
            <path d="M 88,128 L 104,128" fill="none" stroke="black"></path>
            <path d="M 120,128 L 136,128" fill="none" stroke="black"></path>
            <path d="M 304,128 L 360,128" fill="none" stroke="black"></path>
            <path d="M 184,160 L 208,160" fill="none" stroke="black"></path>
            <path d="M 88,206 L 112,206" fill="none" stroke="black"></path>
            <path d="M 88,210 L 112,210" fill="none" stroke="black"></path>
            <path d="M 128,206 L 160,206" fill="none" stroke="black"></path>
            <path d="M 128,210 L 160,210" fill="none" stroke="black"></path>
            <path d="M 176,208 L 224,208" fill="none" stroke="black"></path>
            <path d="M 184,256 L 208,256" fill="none" stroke="black"></path>
            <path d="M 80,288 L 104,288" fill="none" stroke="black"></path>
            <path d="M 120,288 L 144,288" fill="none" stroke="black"></path>
            <path d="M 296,288 L 352,288" fill="none" stroke="black"></path>
            <path d="M 336,320 L 360,320" fill="none" stroke="black"></path>
            <path d="M 336,352 L 352,352" fill="none" stroke="black"></path>
            <path d="M 88,384 L 104,384" fill="none" stroke="black"></path>
            <path d="M 120,384 L 160,384" fill="none" stroke="black"></path>
            <path d="M 280,384 L 360,384" fill="none" stroke="black"></path>
            <path d="M 8,416 L 80,416" fill="none" stroke="black"></path>
            <path d="M 360,416 L 432,416" fill="none" stroke="black"></path>
            <path d="M 184,160 C 175.16936,160 168,167.16936 168,176" fill="none" stroke="black"></path>
            <path d="M 208,160 C 216.83064,160 224,167.16936 224,176" fill="none" stroke="black"></path>
            <path d="M 184,256 C 175.16936,256 168,248.83064 168,240" fill="none" stroke="black"></path>
            <path d="M 208,256 C 216.83064,256 224,248.83064 224,240" fill="none" stroke="black"></path>
            <path d="M 336,320 C 327.16936,320 320,327.16936 320,336" fill="none" stroke="black"></path>
            <path d="M 336,352 C 327.16936,352 320,344.83064 320,336" fill="none" stroke="black"></path>
            <polygon class="arrowhead" points="360,352 348,346.4 348,357.6" fill="black" transform="rotate(0,352,352)"></polygon>
            <polygon class="arrowhead" points="360,288 348,282.4 348,293.6" fill="black" transform="rotate(0,352,288)"></polygon>
            <polygon class="arrowhead" points="360,96 348,90.4 348,101.6" fill="black" transform="rotate(0,352,96)"></polygon>
            <polygon class="arrowhead" points="168,208 156,202.4 156,213.6" fill="black" transform="rotate(0,160,208)"></polygon>
            <polygon class="arrowhead" points="96,384 84,378.4 84,389.6" fill="black" transform="rotate(180,88,384)"></polygon>
            <polygon class="arrowhead" points="96,208 84,202.4 84,213.6" fill="black" transform="rotate(180,88,208)"></polygon>
            <polygon class="arrowhead" points="96,128 84,122.4 84,133.6" fill="black" transform="rotate(180,88,128)"></polygon>
            <g class="text">
              <text x="44" y="52">Client</text>
              <text x="396" y="52">AS</text>
              <text x="44" y="68">Instance</text>
              <text x="112" y="100">1</text>
              <text x="184" y="100">Request</text>
              <text x="244" y="100">Access</text>
              <text x="112" y="132">2</text>
              <text x="192" y="132">Interaction</text>
              <text x="268" y="132">Needed</text>
              <text x="192" y="180">End</text>
              <text x="196" y="196">User</text>
              <text x="120" y="212">3</text>
              <text x="120" y="228">SPC</text>
              <text x="196" y="228">RO</text>
              <text x="112" y="292">4</text>
              <text x="188" y="292">Continue</text>
              <text x="256" y="292">Request</text>
              <text x="296" y="340">(5)</text>
              <text x="296" y="356">SPC</text>
              <text x="112" y="388">6</text>
              <text x="192" y="388">Grant</text>
              <text x="244" y="388">Access</text>
            </g>
          </svg><a href="#section-2-3.1" class="pilcrow">¶</a>
</div>
</div>
<ol start="1" type="1" class="normal type-1" id="section-2-4">
<li id="section-2-4.1">The client instance makes a grant request to the AS, indicating that it can support SPC as an interaction start method. The client instance includes an identifier for the intended end user in the request. The client instance does not include an interaction finish method, since the interaction will happen outside of the AS and the client software will not need to be signaled by the AS to continue the grant request. (<a href="#request-credentials" class="auto internal xref">Section 2.1</a>)<a href="#section-2-4.1" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.2">The AS creates a new grant request in the <em>pending</em> state and responds to the grant request with a challenge to be signed by a set of candidate credentials. (<a href="#serve-credentials" class="auto internal xref">Section 2.2</a>)<a href="#section-2-4.2" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.3">The client instance engages the SPC protocol to sign the challenge. (<a href="#authenticate-user" class="auto internal xref">Section 2.3</a>)<a href="#section-2-4.3" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.4">The client instance continues the grant request, including the results of the SPC challenge response from (3) in the grant continuation request. (<a href="#complete-interaction" class="auto internal xref">Section 2.4</a>)<a href="#section-2-4.4" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.5">The AS validates the signature, completing the SPC process and placing the grant in the <em>approved</em> state. (<a href="#verifying-authentication" class="auto internal xref">Section 3</a>)<a href="#section-2-4.5" class="pilcrow">¶</a>
</li>
        <li id="section-2-4.6">The AS returns an access token in a standard GNAP grant response.<a href="#section-2-4.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-2-5">The end user provides confirmation using their credential, which the client instance presents back to the AS in a continuation response. The AS then verifies this confirmation in order to process the grant request and grant access to the client instance.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="request-credentials">
<section id="section-2.1">
        <h3 id="name-requesting-credentials">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requesting-credentials" class="section-name selfRef">Requesting Credentials</a>
        </h3>
<p id="section-2.1-1">A client instance that is able to use SPC for user interaction can request a grant from an authorization server with SPC as an interaction start method.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The SPC interaction start method is defined as a string type with value <code>spc</code>. If the <code>spc</code> interaction start method is accepted, the corresponding response is returned as discussed in <a href="#serve-credentials" class="auto internal xref">Section 2.2</a>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">When requesting the SPC interaction method the client <span class="bcp14">MUST</span> identify the end user using the <code>user</code> property in the grant request object to allow the AS to find the registered credentials for the user. If the <code>user</code> property is not included in the request, the AS <span class="bcp14">MUST NOT</span> enable this interaction mode for this request.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">A non-normative example of a grant request that uses SPC as its interaction start method is below.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.1-5">
<pre>
"access_token": {
  "access": ["make-payment"]
},
"client": "xyz-client-1234a",
"interact": {
  "start": [
    "spc"
  ]
},
"user": {
  "sub_ids": [{
    "subject_type": "email",
    "email": "user@example.com"
  }]
}
</pre><a href="#section-2.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="serve-credentials">
<section id="section-2.2">
        <h3 id="name-providing-a-credential-chal">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-providing-a-credential-chal" class="section-name selfRef">Providing a Credential Challenge</a>
        </h3>
<p id="section-2.2-1">In response to a client instance’s grant request, if the AS determines that it has a registered SPC credential of the end user, the AS responds with an <code>spc</code> field in the <code>interact</code> object.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The AS determines the end user using <code>user</code> property from the grant request. <code>user</code> property should have the required information such as email addresses, usernames, etc. for determining the end user, see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-gnap-core-protocol-13#section-2.4" class="relref">Section 2.4</a> of [<a href="#GNAP" class="cite xref">GNAP</a>]</span>. If the <code>user</code> property is not included in the request, it is not possible for the AS to determine the credentials for the end user.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-3">
          <dt id="section-2.2-3.1">
<code>spc</code> (object):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-3.2">
            <p id="section-2.2-3.2.1">An object containing parameters required for performing secure payment confirmation on the end user's device. <span class="bcp14">REQUIRED</span> if the AS is allowing SPC interaction for this request.<a href="#section-2.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-4">This object contains the following properties:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-5">
          <dt id="section-2.2-5.1">
<code>credential_ids</code> (array of strings):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.2">
            <p id="section-2.2-5.2.1">A list of identifiers of credentials that could potentially be used to respond to this interaction mode. Each credential identifier <span class="bcp14">MUST</span> be base64url encoded with no padding. <span class="bcp14">REQUIRED</span>.<a href="#section-2.2-5.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-5.3">
<code>challenge</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-5.4">
            <p id="section-2.2-5.4.1">A random challenge that the relying party generates on the server side to prevent replay attacks. The challenge <span class="bcp14">MUST</span> be base64url encoded with no padding. <span class="bcp14">REQUIRED</span>.<a href="#section-2.2-5.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-6">A non-normative example of a grant request continue response that uses SPC as its interaction method is below.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.2-7">
<pre>
{
  "interact": {
    "spc": {
      "credential_ids": ["MTIzMjMxMzIyMz..."],
      "challenge": "dGhpcyBpcyBh..."
    }
  },
  "continue": {
    "access_token": {
      "value": "80UPRY5NM33OMUKMKSKU"
    },
    "uri": "http://wallet.com/adrian/continue/5e69f364-b14d-4fdf-8b6b-3b6ffb52c339"
  }
}
</pre><a href="#section-2.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authenticate-user">
<section id="section-2.3">
        <h3 id="name-authenticating-user">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-authenticating-user" class="section-name selfRef">Authenticating User</a>
        </h3>
<p id="section-2.3-1">When the client instance receives an <code>spc</code> interaction response from the AS, the client instance <span class="bcp14">SHOULD</span> initiate the authentication ceremony following Section 4 of <span>[<a href="#SPC" class="cite xref">SPC</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">When performing this ceremony, the client instance decodes the <code>challenge</code> and each credential from <code>credential_ids</code> using base64url and convert them to a buffer for input into the browser API. When the authentication ceremony is complete, the client instance will have access to the response data from the ceremony to be returned to the AS.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">Each credential id in <code>credential_ids</code> property the AS provided is registered by the end user in the past. When the client initates the authentication ceremony, the browser API is going to check if the device has at least one of the credential ids and continue to the authentication ceremony only if the device has one of the credentials. In this phase, the credential that end user choose as authentication method is going to be used for signing the cryptogram.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="complete-interaction">
<section id="section-2.4">
        <h3 id="name-completing-interaction">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-completing-interaction" class="section-name selfRef">Completing Interaction</a>
        </h3>
<p id="section-2.4-1">Once the authentication ceremony is complete, the client instance continues the grant request by calling the grant continuation URI. The client instance includes a body in the grant continuation request including a field named <code>public_key_cred</code>:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4-2">
          <dt id="section-2.4-2.1">
<code>public_key_cred</code> (object):</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">The results of the SPC authentication ceremony in response to the AS, to be used by the AS to authorize the request.<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.4-3">The <code>public_key_cred</code> object contains the following fields as defined by the Web Authentication Assertion object <span>[<a href="#WebAuthn" class="cite xref">WebAuthn</a>]</span>:<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.4-4">
          <dt id="section-2.4-4.1">
<code>clientDataJSON</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-4.2">
            <p id="section-2.4-4.2.1"><code>clientDataJSON</code> property from Web Authentication Assertion object. This <strong><span class="bcp14">MUST</span></strong> be encoded using base64url. <strong><span class="bcp14">REQUIRED</span></strong>.<a href="#section-2.4-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-4.3">
<code>authenticatorData</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-4.4">
            <p id="section-2.4-4.4.1"><code>authenticatorData</code> property from Web Authentication Assertion object. This <strong><span class="bcp14">MUST</span></strong> be encoded using base64url. <strong><span class="bcp14">REQUIRED</span></strong>.<a href="#section-2.4-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-4.5">
<code>signature</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-4.6">
            <p id="section-2.4-4.6.1"><code>signature</code> property from Web Authentication Assertion object. This <strong><span class="bcp14">MUST</span></strong> be encoded using base64url. <strong><span class="bcp14">REQUIRED</span></strong>.<a href="#section-2.4-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.4-4.7">
<code>userHandle</code> (string):</dt>
          <dd style="margin-left: 1.5em" id="section-2.4-4.8">
            <p id="section-2.4-4.8.1"><code>userHandle</code> property from Web Authentication Assertion object. This <strong><span class="bcp14">MUST</span></strong> be encoded using base64url. <strong><span class="bcp14">REQUIRED</span></strong>.<a href="#section-2.4-4.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.4-5">A non-normative example of an interaction completion response body is below.<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<div class="lang-json sourcecode" id="section-2.4-6">
<pre>
{
  "public_key_cred": {
    "clientDataJSON": "ZXhhbXBsZSBjbGllbnRkYXR...",
    "authenticatorData": "YXV0aGVudGljYXRvckRhdGEg...",
    "signature": "c2lnbmF0dXJlIGV4YW...",
    "userHandle": "dXNlckhhbmRsZSBleG..."
  }
}
</pre><a href="#section-2.4-6" class="pilcrow">¶</a>
</div>
<p id="section-2.4-7">Since the signature is in response to a challenge provided by the AS, the client instance <span class="bcp14">MUST NOT</span> send this parameter to a new grant request. The grant request <span class="bcp14">MUST</span> be in the <em>pending</em> state when this parameter is sent to the AS.<a href="#section-2.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verifying-authentication">
<section id="section-3">
      <h2 id="name-verifying-authentication-as">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-verifying-authentication-as" class="section-name selfRef">Verifying Authentication Assertion</a>
      </h2>
<p id="section-3-1">When the AS receives the <code>public_key_cred</code> value in a grant continuation request, the AS <span class="bcp14">MUST</span> perform the steps specified in Section 8.1 of <span>[<a href="#SPC" class="cite xref">SPC</a>]</span>. Each property of a public key credential returned successful invocation of the SPC handler <code>clientDataJSON</code>, <code>authenticatorData</code>, <code>signature</code> and <code>userHandle</code> <span class="bcp14">MUST</span> be present as expected for starting verification. The AS <span class="bcp14">MUST</span> decode each property of the public key credential in the response using base64url before performing the verification.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The grant request <span class="bcp14">MUST</span> be in the <em>pending</em> state when this parameter is received in order for it to be processed. If the grant request is in any other state, the AS <span class="bcp14">MUST</span> return an error.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The AS <span class="bcp14">MUST</span> ensure that the transaction details encoded in the public key credential match the details of the transaction that the client instance is requesting a grant to perform.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">If the AS determines that the authorization is sufficient, the AS grants access tokens and releases subject information to the client instance.<a href="#section-3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">TODO Security<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">IANA is requested to register the following values into the named registries.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="interaction-start-modes">
<section id="section-5.1">
        <h3 id="name-interaction-start-modes">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-interaction-start-modes" class="section-name selfRef">Interaction Start Modes</a>
        </h3>
<p id="section-5.1-1">IANA is requested to register the following modes into the Interaction Start Modes registry defined by <span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Mode</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">spc</td>
              <td class="text-left" rowspan="1" colspan="1">string</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#request-credentials" class="auto internal xref">Section 2.1</a> of RFC nnnn</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="interaction-mode-responses">
<section id="section-5.2">
        <h3 id="name-interaction-mode-responses">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-interaction-mode-responses" class="section-name selfRef">Interaction Mode Responses</a>
        </h3>
<p id="section-5.2-1">IANA is requested to register the following methods into the Interaction Mode Responses registry defined by <span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">spc</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#serve-credentials" class="auto internal xref">Section 2.2</a> of RFC nnnn</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="grant-request-parameters">
<section id="section-5.3">
        <h3 id="name-grant-request-parameters">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-grant-request-parameters" class="section-name selfRef">Grant Request Parameters</a>
        </h3>
<p id="section-5.3-1">IANA is requested to register the following parameters into the Grant Request Parameters registry defined by <span>[<a href="#GNAP" class="cite xref">GNAP</a>]</span>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Specification document(s)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">public_key_cred</td>
              <td class="text-left" rowspan="1" colspan="1">object</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#complete-interaction" class="auto internal xref">Section 2.4</a> of RFC nnnn</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-6">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-6-1">TODO acknowledge.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="GNAP">[GNAP]</dt>
        <dd>
<span class="refAuthor">Richer, J.</span> and <span class="refAuthor">F. Imbault</span>, <span class="refTitle">"Grant Negotiation and Authorization Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-gnap-core-protocol-13</span>, <time datetime="2023-02-27" class="refDate">27 February 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-gnap-core-protocol-13">https://datatracker.ietf.org/doc/html/draft-ietf-gnap-core-protocol-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SPC">[SPC]</dt>
        <dd>
<span class="refTitle">"Secure Payment Confirmation"</span>, <span class="seriesInfo">W3C WD secure-payment-confirmation</span>, <span class="seriesInfo">W3C secure-payment-confirmation</span>, <span>&lt;<a href="https://www.w3.org/TR/secure-payment-confirmation/">https://www.w3.org/TR/secure-payment-confirmation/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WebAuthn">[WebAuthn]</dt>
      <dd>
<span class="refTitle">"Web Authentication: An API for accessing Public Key Credentials - Level 3"</span>, <span class="seriesInfo">W3C WD webauthn-3</span>, <span class="seriesInfo">W3C webauthn-3</span>, <span>&lt;<a href="https://www.w3.org/TR/webauthn-3/">https://www.w3.org/TR/webauthn-3/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="PaymentRequest">[PaymentRequest]</dt>
      <dd>
<span class="refTitle">"Payment Request API 1.1"</span>, <span class="seriesInfo">W3C WD payment-request-1.1</span>, <span class="seriesInfo">W3C payment-request-1 1</span>, <span>&lt;<a href="https://www.w3.org/TR/payment-request-1.1/">https://www.w3.org/TR/payment-request-1.1/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="detect-spc">
<section id="appendix-A">
      <h2 id="name-checking-feature-support">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-checking-feature-support" class="section-name selfRef">Checking Feature Support</a>
      </h2>
<p id="appendix-A-1">This extension only works if the end user's user agent supports the Payment Request API <span>[<a href="#PaymentRequest" class="cite xref">PaymentRequest</a>]</span> and SPC. To detect whether SPC is supported on the browser, the client instance can send a fake call to <code>canMakePayment()</code>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The following code provides a feature detect function for the Payment Request API and SPC that could be executed on a merchant's website.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="lang-javascript sourcecode" id="appendix-A-3">
<pre>
const isSecurePaymentConfirmationSupported = async () =&gt; {
  if (!'PaymentRequest' in window) {
    return [false, 'Payment Request API is not supported'];
  }

  try {
    // The data below is the minimum required to create the request and
    // check if a payment can be made.
    const supportedInstruments = [
      {
        supportedMethods: "secure-payment-confirmation",
        data: {
          // RP's hostname as its ID
          rpId: 'rp.example',
          // A dummy credential ID
          credentialIds: [new Uint8Array(1)],
          // A dummy challenge
          challenge: new Uint8Array(1),
          instrument: {
            // Non-empty display name string
            displayName: ' ',
            // Transparent-black pixel.
            icon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+P+/HgAFhAJ/wlseKgAAAABJRU5ErkJggg==',
          },
          // A dummy merchant origin
          payeeOrigin: 'https://non-existent.example',
        }
      }
    ];

    const details = {
      // Dummy shopping details
      total: {label: 'Total', amount: {currency: 'USD', value: '0'}},
    };

    const request = new PaymentRequest(supportedInstruments, details);
    const canMakePayment = await request.canMakePayment();
    return [canMakePayment, canMakePayment ? '' : 'SPC is not available'];
  } catch (error) {
    console.error(error);
    return [false, error.message];
  }
};
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Omer Talha Ozdemir</span></div>
<div dir="auto" class="left"><span class="org">Fynbos</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:omer@fynbos.dev" class="email">omer@fynbos.dev</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adrian Hope-Bailie</span></div>
<div dir="auto" class="left"><span class="org">Fynbos</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adrian@fynbos.dev" class="email">adrian@fynbos.dev</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
